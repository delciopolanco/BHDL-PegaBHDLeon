import { Injectable } from "@angular/core";
import { CanActivate, ActivatedRouteSnapshot, Router } from "@angular/router";
import { Platforms } from "../_services/themes";

@Injectable()
export class TempEnrolledGuard implements CanActivate {
  constructor(private router: Router) {}

  canActivate(route: ActivatedRouteSnapshot) {
    console.log("Temp Enrollment Guard initialized!");
    const theme = JSON.parse(localStorage.getItem("theme"));
    if (
      theme &&
      (theme.platform === Platforms.ANDROID || theme.platform === Platforms.IOS)
    ) {
      this.setCredentialsToLocalStorage();
    } else {
      this.removeCredentialsFromLocalStorage();
    }
    return true;
  }

  removeCredentialsFromLocalStorage() {
    const mobile = JSON.parse(localStorage.getItem("mobile"));
    const credentials = JSON.parse(localStorage.getItem("credentials"));
    if (mobile && credentials) {
      localStorage.removeItem("mobile");
      localStorage.removeItem("credentials");
    }
  }
  setCredentialsToLocalStorage() {
    const credentials = {
      message: "Dispositivo enrolado existosamente",
      code: "200",
      clientId: "a1aadf98-8be4-4b2d-8818-c310f86a685e",
      clientSecret: "5263f06a-0c23-4972-97cf-85eddd8960cf",
      x509cert:
        "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMwakNDQWJxZ0F3SUJBZ0lFUldnRkx6QU5CZ2txaGtpRzl3MEJBUVVGQURBck1Ta3dKd1lEVlFRREV5QXoKTVdVNVpXTm1PRFU1WkdFNE9XSmtZVEk1TnpFeFpEYzBaakV3WVRCbVlqQWVGdzB5TURBNU1Ea3lNalV5TkRGYQpGdzB5TWpBNU1Ea3lNalV5TkRGYU1Dc3hLVEFuQmdOVkJBTVRJRE14WlRsbFkyWTROVGxrWVRnNVltUmhNamszCk1URmtOelJtTVRCaE1HWmlNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQTNGbGQKWlFXNms1MlQzV1o0QzN3STZTWVVZYzZFbkQxWGYzeVBBWTlDeFVFUmtHUWtZQmNTUUJPSEdPYUtudXgzbTRZZQo4d1QxMFZJSzkwbkI2dGRPMUdPRjFyQWRadjN0em1JV2JCOGNndkJLblNMWlBQSExaOGtkZ3NhcFdaekZyMkQ4CmpvaENZRE8waE5HOVZ1TDZDeWU0Y09vUyt1YS9VOHJmK1Baa3FOSEh4STc2QUVOTVVld09UOUlzejRRSHN4RUgKYWNkbG9lQ2tJWlhFVmtJY1QvNmkyMDhJNG41WnU1c1FhdkRiUzNCSDhXekZYeG5jZ29qZHVqRVlhOWE5SCtpSgp6cHQ1cjh4M0RHaW94ZEl2ZFV5M2hvbE1xZHVsOU5YVm9VVXo0czlnT2VwQmYySk9KaVk1d3lNMlVpWjM1aEhWCmxmRVM5SFdRdGVJMWlsd3ovUUlEQVFBQk1BMEdDU3FHU0liM0RRRUJCUVVBQTRJQkFRQmd1MTNZejVVeFhoNkUKdFRNd2RZcHVkMG9zakFYb3FndG40TURQdFRScTNYcEJ5L1FCeXhIRzAvU0NOclpFUVVyejhpZzVTYUNFQXRKRgpSRzVseXhPVjVsY2V4dEE3bXFlZmpHaW5uaEg3UUx1eDkyTDFnZjRkN044dUtPb2hJYXk4SG15ZklCcStWdzYxCkFRSExIMHl0YkE2V1hEbndVZDhQSFI1cUJkOVVjVkJReEdjcHNPWGdHZks4OFJhNmlmUElBMUlOeDBSdzREMFcKN0N0MmRHMnE0d01CSFZBMVJ5R29nazZsN3JTM2xaZmp5b29XMXo0THpTdDFwNjdrL0VVallUL3Njb3JJUE1lMApXVEIzUi9ETjhrdXl5Y2Rjb0RLbTgvYjgrQmkrekVTVDlkeUtRaXBURmlya2NFUVVxVHM2M01CSDdhK1Q1WG5hCitXR1Z2U21uCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K",
    };
    const mbp = {
      deviceId:
        "eyJmaW5nZXJwcmludCI6IjMxZTllY2Y4NTlkYTg5YmRhMjk3MTFkNzRmMTBhMGZiIiwiZmluZ2VycHJpbnRJbmZvIjp7InJhbmRvbVNlZWQiOiI3NGM4N2NiYS1jNTMwLTRhNmEtOGY2Zi1iYTVlNjRmYWE3NWEiLCJsYW5ndWFnZSI6ImVzLVVTIiwiY29sb3JEZXB0aCI6MjQsInRpbWV6b25lT2Zmc2V0IjoyNDAsImhhc1Nlc3Npb25TdG9yYWdlIjp0cnVlLCJoYXNMb2NhbFN0b3JhZ2UiOnRydWUsImhhc0luZGV4ZWREYiI6dHJ1ZSwiaGFzQWRkQmVoYXZpb3IiOmZhbHNlLCJoYXNPcGVuRGF0YWJhc2UiOnRydWUsIm5hdmlnYXRvckNwdUNsYXNzIjoibmF2aWdhdG9yQ3B1Q2xhc3M6IHVua25vd24iLCJuYXZpZ2F0b3JQbGF0Zm9ybSI6Im5hdmlnYXRvclBsYXRmb3JtOiBXaW4zMiIsImRvTm90VHJhY2siOiJkb05vdFRyYWNrOiB1bmtub3duIiwicGx1Z2lucyI6IiIsImhhc0FkQmxvY2siOmZhbHNlLCJoYXNMaWVkTGFuZ3VhZ2VzIjpmYWxzZSwiaGFzTGllZFJlc29sdXRpb24iOmZhbHNlLCJoYXNMaWVkT3MiOnRydWUsImZvbnRzIjoiIiwiY3JjQ2FudmFzIjoiNmZhYmUyNGYiLCJjcmNXZWJHbCI6IjM1YmNmOGI0Iiwic2NyZWVuUmVzb2x1dGlvbkluZm8iOnsic2NyZWVuSGVpZ2h0Ijo2NDAsInNjcmVlbldpZHRoIjozNjAsImF2YWlsYWJsZUhlaWdodCI6NjQwLCJhdmFpbGFibGVXaWR0aCI6MzYwfX0sInN5c3RlbUluZm8iOnsidWEiOiJNb3ppbGxhLzUuMCAoTGludXg7IFU7IEFuZHJvaWQgNC4zOyBlbi11czsgU00tTjkwMFQgQnVpbGQvSlNTMTVKKSBBcHBsZVdlYktpdC81MzQuMzAgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBNb2JpbGUgU2FmYXJpLzUzNC4zMCIsImJyb3dzZXIiOnsibmFtZSI6IkFuZHJvaWQgQnJvd3NlciIsInZlcnNpb24iOiI0LjAiLCJtYWpvciI6IjQifSwiZW5naW5lIjp7Im5hbWUiOiJXZWJLaXQiLCJ2ZXJzaW9uIjoiNTM0LjMwIn0sIm9zIjp7Im5hbWUiOiJBbmRyb2lkIiwidmVyc2lvbiI6IjQuMyJ9LCJkZXZpY2UiOnsidmVuZG9yIjoiU2Ftc3VuZyIsIm1vZGVsIjoiU00tTjkwMFQiLCJ0eXBlIjoibW9iaWxlIn0sImNwdSI6e319fQ==",
      credentials: {
        message: "Dispositivo enrolado existosamente",
        code: "200",
        clientId: "e90ab777-cd3b-4d4d-9bec-dff652b0c1dd",
        clientSecret: "eb2b99a5-c3ce-49d0-88fc-05b73c5a52f9",
        x509cert:
          "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSU55akNDRExLZ0F3SUJBZ0lFR2gySG9UQU5CZ2txaGtpRzl3MEJBUVVGQURDQ0JhVXhnZ1doTUlJRm5RWUQKVlFRREU0SUZsR1Y1U20xaFZ6VnVXbGhLZDJOdGJIVmtRMGsyU1dwTmVGcFViR3haTWxrMFRsUnNhMWxVWnpWWgpiVkpvVFdwck0wMVVSbXRPZWxKdFRWUkNhRTFIV21sSmFYZHBXbTFzZFZveVZubGpTRXB3WW01U1NtSnRXblpKCmFuQTNTVzVLYUdKdFVuWmlWazVzV2xkUmFVOXBTVE5PUjAwMFRqSk9hVmxUTVdwT1ZFMTNURlJTYUU1dFJYUlAKUjFreVdta3hhVmxVVm14T2FsSnRXVmRGTTA1WFJXbE1RMHB6V1ZjMWJtUlhSbTVhVTBrMlNXMVdla3hXVmxSSgphWGRwV1RJNWMySXpTa1ZhV0VJd1lVTkpOazFxVVhOSmJsSndZbGRXTm1JeU5XeFVNbHB0WXpKV01FbHFiM2xPClJFRnpTVzFvYUdNeFRteGpNMDV3WWpJMVZHUkhPWGxaVjJSc1NXcHdNR051Vm14TVEwcHZXVmhPVFdJeVRtaGkKUms0d1lqTkthRm95VldsUGJsSjVaRmRWYzBsdGFHaGpNR3gxV2tkV05GcFhVa1ZaYVVrMlpFaEtNVnBUZDJsaApSMFo2VVZkU2ExRnRWbTlaV0Zwd1lqTkphVTl0V21oaVNFNXNURU5LYjFsWVRsQmpSMVoxVWtkR01GbFhTbWhqCk1sVnBUMjVTZVdSWFZYTkpiVFZvWkcxc2JsbFlVblpqYTA1M1pGVk9jMWxZVG5wSmFtOXBZbTFHTW1GWFpHaGsKUnpsNVVUTkNNVkV5ZUdoak0wMDJTVWhXZFdFeU5YWmtNalJwVEVOS2RWbFlXbkJhTWtZd1lqTktVV0pIUmpCYQpiVGw1WWxOSk5rbHROV2hrYld4dVdWaFNkbU5zUW5OWldGSnRZak5LZEU5cFFsaGhWelI2VFdsSmMwbHRVblpVCmJUa3dWa2hLYUZreWMybFBhVXByWWpBMWRtUkdVbmxaVjA1eVQybENNV0p0ZEhWaU0yUjFTV2wzYVdOSGVERmEKTW14MVkzbEpOa2xwU1hOSmJXaG9ZekJHYTFGdGVIWlpNbk5wVDIxYWFHSklUbXhNUTBwdldWaE9UV0ZYVm10VQpSMFoxV2pOV2FGb3lWbnBKYW5CdFdWZDRlbHBUZDJsaFIwWjZWRWRzYkZwR1NteGpNamx6WkZoU2NHSXlOR2xQCmJWcG9Za2hPYkV4RFNtOVpXRTVOWVZkV2ExUXpUV2xQYmxKNVpGZFZjMGx0V25aaWJsSjZTV3B2YVVscGQybFoKTTBwcVVUSkdkV1J0Um5wSmFtOXBUbTFhYUZsdFZYbE9SMWxwVEVOS2FtTnRUbGhhVjBwSVlrTkpOa2xxVFRGWgpiVTV0VDBkSk1FbHBkMmxqTWs1NVdsZFdkVlZ0Vm5waU1uZ3haRWRzZG1KcmJIVmFiVGhwVDI1emFXTXlUbmxhClYxWjFVMGRXY0ZveWFEQkphbTh5VGtSQmMwbHVUbXBqYlZac1lteGtjRnBJVW05SmFtOTZUbXBCYzBsdFJqSloKVjJ4eldWZEtjMXBWYUd4aFYyUnZaRU5KTms1cVVYZE1RMHBvWkcxR2NHSkhSbWxpUjFaWVlWZFNNR0ZEU1RaTgplbGwzWmxnd2MwbHVUalZqTTFKc1lsVnNkVnB0T0dsUGJuTnBaRmRGYVU5cFNrNWlNM0J3WWtkNGFFeDZWWFZOClEwRnZWRWRzZFdSWVp6ZEpSbFUzU1VWR2RWcElTblpoVjFGblRrTTBlazk1UW14aWFURXhZM3B6WjFVd01IUlUKYW10M1RVWlJaMUZ1Vm5CaVIxRjJVMnhPVkUxVVZrdExVMEpDWTBoQ2MxcFdaR3haYTNSd1pFTTRNVTE2VVhWTgpla0ZuUzBWMFNWWkZNVTFNUTBKellWZDBiRWxGWkd4Wk1uUjJTMU5DVjFwWVNucGhWemwxVEhwUmRVMURRazVpCk1rcHdZa2RWWjFVeVJtMVpXRXB3VEhwVmVrNUROSHBOUTBselNXMUtlV0l6WkhwYVdFbHBUMjV6YVdKdFJuUmEKVTBrMlNXdEdkVnBJU25aaFYxRm5VVzVLZG1RelRteGphVWx6U1c1YWJHTnVUbkJpTWpScFQybEpNRXhxUVdsTQpRMHAwV1Zkd2RtTnBTVFpKYWxGcFpsTjNhVnBYTlc1aFZ6VnNTV3B3TjBsdE5XaGlWMVZwVDJsS1dGcFhTa3hoCldGRnBURU5LTWxwWVNucGhWemwxU1dwdmFVNVVUVEJNYWsxM1NXNHdjMGx0T1hwSmFuQTNTVzAxYUdKWFZXbFAKYVVwQ1ltMVNlV0l5Ykd0SmFYZHBaRzFXZVdNeWJIWmlhVWsyU1dwUmRVMTVTamxNUTBwcldsaGFjRmt5VldsUApibk5wWkcxV2RWcEhPWGxKYW05cFZUSkdkR016Vm5WYWVVbHpTVzB4ZGxwSFZuTkphbTlwVlRBd2RGUnFhM2ROClJsRnBURU5LTUdWWVFteEphbTlwWWxjNWFXRlhlR3hKYmpCelNXMU9kMlJUU1RabE16RTVabEU5UFRBZUZ3MHkKTURBNU1Ea3lNekUyTVRoYUZ3MHlNakE1TURreU16RTJNVGhhTUlJRnBUR0NCYUV3Z2dXZEJnTlZCQU1UZ2dXVQpaWGxLYldGWE5XNWFXRXAzWTIxc2RXUkRTVFpKYWsxNFdsUnNiRmt5V1RST1ZHeHJXVlJuTlZsdFVtaE5hbXN6ClRWUkdhMDU2VW0xTlZFSm9UVWRhYVVscGQybGFiV3gxV2pKV2VXTklTbkJpYmxKS1ltMWFka2xxY0RkSmJrcG8KWW0xU2RtSldUbXhhVjFGcFQybEpNMDVIVFRST01rNXBXVk14YWs1VVRYZE1WRkpvVG0xRmRFOUhXVEphYVRGcApXVlJXYkU1cVVtMVpWMFV6VGxkRmFVeERTbk5aVnpWdVpGZEdibHBUU1RaSmJWWjZURlpXVkVscGQybFpNamx6CllqTktSVnBZUWpCaFEwazJUV3BSYzBsdVVuQmlWMVkyWWpJMWJGUXlXbTFqTWxZd1NXcHZlVTVFUVhOSmJXaG8KWXpGT2JHTXpUbkJpTWpWVVpFYzVlVmxYWkd4SmFuQXdZMjVXYkV4RFNtOVpXRTVOWWpKT2FHSkdUakJpTTBwbwpXakpWYVU5dVVubGtWMVZ6U1cxb2FHTXdiSFZhUjFZMFdsZFNSVmxwU1Raa1NFb3hXbE4zYVdGSFJucFJWMUpyClVXMVdiMWxZV25CaU0wbHBUMjFhYUdKSVRteE1RMHB2V1ZoT1VHTkhWblZTUjBZd1dWZEthR015VldsUGJsSjUKWkZkVmMwbHROV2hrYld4dVdWaFNkbU5yVG5ka1ZVNXpXVmhPZWtscWIybGliVVl5WVZka2FHUkhPWGxSTTBJeApVVEo0YUdNelRUWkpTRloxWVRJMWRtUXlOR2xNUTBwMVdWaGFjRm95UmpCaU0wcFJZa2RHTUZwdE9YbGlVMGsyClNXMDFhR1J0Ykc1WldGSjJZMnhDYzFsWVVtMWlNMHAwVDJsQ1dHRlhOSHBOYVVselNXMVNkbFJ0T1RCV1NFcG8KV1RKemFVOXBTbXRpTURWMlpFWlNlVmxYVG5KUGFVSXhZbTEwZFdJelpIVkphWGRwWTBkNE1Wb3liSFZqZVVrMgpTV2xKYzBsdGFHaGpNRVpyVVcxNGRsa3ljMmxQYlZwb1lraE9iRXhEU205WldFNU5ZVmRXYTFSSFJuVmFNMVpvCldqSldla2xxY0cxWlYzaDZXbE4zYVdGSFJucFVSMnhzV2taS2JHTXlPWE5rV0ZKd1lqSTBhVTl0V21oaVNFNXMKVEVOS2IxbFlUazFoVjFaclZETk5hVTl1VW5sa1YxVnpTVzFhZG1KdVVucEphbTlwU1dsM2FWa3pTbXBSTWtaMQpaRzFHZWtscWIybE9iVnBvV1cxVmVVNUhXV2xNUTBwcVkyMU9XRnBYU2toaVEwazJTV3BOTVZsdFRtMVBSMGt3ClNXbDNhV015VG5sYVYxWjFWVzFXZW1JeWVERmtSMngyWW10c2RWcHRPR2xQYm5OcFl6Sk9lVnBYVm5WVFIxWncKV2pKb01FbHFiekpPUkVGelNXNU9hbU50Vm14aWJHUndXa2hTYjBscWIzcE9ha0Z6U1cxR01sbFhiSE5aVjBwegpXbFZvYkdGWFpHOWtRMGsyVG1wUmQweERTbWhrYlVad1lrZEdhV0pIVmxoaFYxSXdZVU5KTmsxNldYZG1XREJ6ClNXNU9OV016VW14aVZXeDFXbTA0YVU5dWMybGtWMFZwVDJsS1RtSXpjSEJpUjNob1RIcFZkVTFEUVc5VVIyeDEKWkZobk4wbEdWVGRKUlVaMVdraEtkbUZYVVdkT1F6UjZUM2xDYkdKcE1URmplbk5uVlRBd2RGUnFhM2ROUmxGbgpVVzVXY0dKSFVYWlRiRTVVVFZSV1MwdFRRa0pqU0VKeldsWmtiRmxyZEhCa1F6Z3hUWHBSZFUxNlFXZExSWFJKClZrVXhUVXhEUW5OaFYzUnNTVVZrYkZreWRIWkxVMEpYV2xoS2VtRlhPWFZNZWxGMVRVTkNUbUl5U25CaVIxVm4KVlRKR2JWbFlTbkJNZWxWNlRrTTBlazFEU1hOSmJVcDVZak5rZWxwWVNXbFBibk5wWW0xR2RGcFRTVFpKYTBaMQpXa2hLZG1GWFVXZFJia3AyWkROT2JHTnBTWE5KYmxwc1kyNU9jR0l5TkdsUGFVa3dUR3BCYVV4RFNuUlpWM0IyClkybEpOa2xxVVdsbVUzZHBXbGMxYm1GWE5XeEphbkEzU1cwMWFHSlhWV2xQYVVwWVdsZEtUR0ZZVVdsTVEwb3kKV2xoS2VtRlhPWFZKYW05cFRsUk5NRXhxVFhkSmJqQnpTVzA1ZWtscWNEZEpiVFZvWWxkVmFVOXBTa0ppYlZKNQpZakpzYTBscGQybGtiVlo1WXpKc2RtSnBTVFpKYWxGMVRYbEtPVXhEU210YVdGcHdXVEpWYVU5dWMybGtiVloxCldrYzVlVWxxYjJsVk1rWjBZek5XZFZwNVNYTkpiVEYyV2tkV2MwbHFiMmxWTURCMFZHcHJkMDFHVVdsTVEwb3cKWlZoQ2JFbHFiMmxpVnpscFlWZDRiRWx1TUhOSmJVNTNaRk5KTm1Vek1UbG1VVDA5TUlJQklqQU5CZ2txaGtpRwo5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBbTZyZFdiNjRqQ29mdG9rbTh2NmVHMndHZUcrZnRlbnFWWVJsCjdCbnFaK0VvWVMzSXdkOUI2cHc1UTQ0d0tyM0VPeWhZaEh5L2lKYmUzbE4vbzU2ZkFhOHJ6T0lnTFdDVVg1c1kKVEpnVkQwcUluWFdyWlBDclhpZkI2bFpNOVZ0RXYzdXh3RnNuWkZuSHJkSUNCcFFFNUpwVTAvRVp2RDBVeS9xYgpZL2owQndLTW95V2d4MzZBaHJOUmhvT2lkb0dKVE1LZmpvOG0rUThrZVhCRGJydzdiS2VSVDdvRnFGYU1vbjczCllXZWdhemN4VUJIUklvYXhOUmQxZzFVeVpxakhiLzdvSW9RclFZYm1qYXhHZkZzSFJITmZ6a1Bua0hGQnU5Uk8KWmFTNjRnN2lkUmFjNVhTakR3UG5MR3BlM0U1YzFTQ2lHb1MrVy9FZHJhZlQraDJzVHdJREFRQUJNQTBHQ1NxRwpTSWIzRFFFQkJRVUFBNElCQVFCZlIwOGJrUmFIWDVZRFpqQVUvUVYxWmRYbjAwZldEcXU0Sm9RdytZdHVRbmx6CjNCSnBoc2lhbXhaOWxYMUR2b09zUlNJU1JXSW5scmlwMHM2TXlIN1V5aHhwZ3VyZFgzcnJzc0FteUR3RDlucEsKQWNrUUZCWmR5TzVkVDFRSDZMcm13aHpscEVvOFlnWGlsOHhTY2JFSDZNclBnNXFqdktML1FLNHlYazZpQkJYSQpwWHlKRmhIZ242eDhXbFdkUVgvWjFtaEUrVVFDdHVQU2RzQ2dwV2h2Q0loTGhnT1NwQ2ZYWS9oa1FlK3ZrSmc2ClhUR1AybFlPekx2L0U2eG4xNGJaRFY2SUtQNGIrTkE5OWpGbnpiQVBUU2owR3ZHaWRLbTBaejhjVm1ickxuOFQKRGpzN0s1Tkh5dXlyVTlON1pOMHdhYlJRV0NiNjNPVlJLZE9MaHdTUQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==",
      },
    };
    localStorage.setItem("mobile", JSON.stringify(mbp));
    localStorage.setItem("credentials", JSON.stringify(credentials));
  }
}
